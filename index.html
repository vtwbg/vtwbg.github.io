<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8"/>

    <title>/vtwbg/ Map Viewer</title>

    <style>
      body {
        font-size: 15px;
        background-color: lightgray;
      }

      h1 {
        font-size: 30px;
        margin-left: 50px;
      }

      img {
        width: 50%;
        display: none;
      }

      p {
        margin-top: .5em;
        margin-bottom: .5em;
        margin-left: 50px;
      }

      .wrapper {
        overflow-x: auto;
        white-space: nowrap;
        width: 50%;
      }

      .z1{z-index:1;position:absolute;}
      .z2{z-index:2;position:absolute;}
      .z3{z-index:3;position:absolute;}
      .z4{z-index:4;position:absolute;}
      .z5{z-index:5;position:absolute;}
      .z6{z-index:6;position:absolute;}
      .z7{z-index:7;position:absolute;}
      .z8{z-index:8;position:absolute;}
      .z9{z-index:9;position:absolute;}

    </style>

    <script>
        function full() {
            document.getElementById("top").style.display="block";
            document.getElementById("blank").style.display="";
            document.getElementById("flat").style.display="";
            document.getElementById("color").style.display="";
            document.getElementById("climate").style.display="";
            document.getElementById("top2").style.display="block";
            document.getElementById("blank2").style.display="";
            document.getElementById("flat2").style.display="";
            document.getElementById("color2").style.display="";
            document.getElementById("climate2").style.display="";
            document.getElementById("key").style.display="";
        }
    </script>

    <script>
        function simple() {
            document.getElementById("top").style.display="";
            document.getElementById("blank").style.display="block";
            document.getElementById("flat").style.display="";
            document.getElementById("color").style.display="";
            document.getElementById("climate").style.display="";
            document.getElementById("top2").style.display="";
            document.getElementById("blank2").style.display="block";
            document.getElementById("flat2").style.display="";
            document.getElementById("color2").style.display="";
            document.getElementById("climate2").style.display="";
            document.getElementById("key").style.display="";
        }
    </script>

    <script>
        function off() {
            document.getElementById("top").style.display="";
            document.getElementById("blank").style.display="block";
            document.getElementById("flat").style.display="block";
            document.getElementById("color").style.display="";
            document.getElementById("climate").style.display="";
            document.getElementById("top2").style.display="";
            document.getElementById("blank2").style.display="block";
            document.getElementById("flat2").style.display="block";
            document.getElementById("color2").style.display="";
            document.getElementById("climate2").style.display="";
            document.getElementById("key").style.display="";
        }
    </script>

    <script>
        function color() {
            document.getElementById("top").style.display="";
            document.getElementById("blank").style.display="block";
            document.getElementById("flat").style.display="";
            document.getElementById("color").style.display="block";
            document.getElementById("climate").style.display="";
            document.getElementById("top2").style.display="";
            document.getElementById("blank2").style.display="block";
            document.getElementById("flat2").style.display="";
            document.getElementById("color2").style.display="block";
            document.getElementById("climate2").style.display="";
            document.getElementById("key").style.display="";
        }
    </script>

    <script>
        function climate() {
            document.getElementById("top").style.display="";
            document.getElementById("blank").style.display="block";
            document.getElementById("flat").style.display="";
            document.getElementById("color").style.display="";
            document.getElementById("climate").style.display="block";
            document.getElementById("top2").style.display="";
            document.getElementById("blank2").style.display="block";
            document.getElementById("flat2").style.display="";
            document.getElementById("color2").style.display="";
            document.getElementById("climate2").style.display="block";
            document.getElementById("key").style.display="block";
        }
    </script>

    <script>
        function toggle(id) {
          var active=document.getElementById(id).style.display!="block";
          document.getElementById(id).style.display="block".repeat(active);
          document.getElementById(id+"2").style.display="block".repeat(active);
        }
      </script>

        <script>
            function wrap() {
              var active=document.getElementById("right").style.display=="none";
              document.getElementById("left").style.marginLeft=50*(1-active)+"px";
              document.getElementById("right").style.display=["block","none"][1-active];
            }
        </script>

        <script>
          function save() {
            var layers=["top","blank","flat","color","climate","border","grid","label"];
            var wrap=document.getElementById("right").style.display=="block";
            if (wrap){
              var pic=document.getElementById("double");
            }
            else{
              var pic=document.getElementById("single");
            }
            layers.forEach(function(i){
              if (document.getElementById(i).style.display=="block"){
                pic.getContext("2d").drawImage(document.getElementById(i),0,0);
              }
            })
            if (wrap){
              layers.forEach(function(i){
                if (document.getElementById(i+"2").style.display=="block"){
                  pic.getContext("2d").drawImage(document.getElementById(i),6000,0);
                }
              })
            }
            var image = document.createElement("a");
            image.setAttribute("href", pic.toDataURL());
            image.setAttribute("download","map.png");
            image.click();
            image.remove();
          }
        </script>

  </head>

  <body>

<div style="float:left">
  <h1>/vtwbg/ Map Viewer</h1>

  <p>Style:</p>
    <button onclick="full()" style="margin-left: 50px">Height</button>
    <button onclick="simple()">Simple</button>
    <button onclick="off()">Mono</button>
    <button onclick="color()">Color</button>
    <button onclick="climate()">Climate</button>
  <p>Toggles:</p>
    <button onclick="toggle('border')" style="margin-left: 50px">Borders</button>
    <button onclick="toggle('grid')">Grid</button>
    <button onclick="toggle('label')">Labels</button>
    <button onclick="wrap()">Wrap</button>
  <p>Zoom:</p>
    <button id="plus" style="margin-left: 50px">+</button>
    <button id="minus">-</button>
    <button id="reset">Reset</button>
  <p>Tools:</p>
    <button onclick="save()" style="margin-left: 50px">Download</button>
    <input id="dist" type="text" readonly="True" placeholder="click to set waypoints">
    <button id="area">Area</button>
    <button id="clear">Clear</button>
</div>

<img id="key" src="key.png" style="width:25%;float:left;margin-left:40px;margin-top:100px"/>

  <script>
    var curr=50;
    var layers=["maps","top","blank","flat","color","climate","border","grid","label","top2","blank2","flat2","color2","climate2","border2","grid2","label2"];
    function update(){
      layers.forEach(function(i){
        document.getElementById(i).style.width=curr+"%";
      })
      document.getElementById("lines").getContext("2d").canvas.width=window.innerWidth*curr/100;
      document.getElementById("lines").getContext("2d").canvas.height=window.innerWidth*curr/200;
      document.getElementById("lines2").getContext("2d").canvas.width=window.innerWidth*curr/100;
      document.getElementById("lines2").getContext("2d").canvas.height=window.innerWidth*curr/200;
    }
    document.getElementById("plus").addEventListener("click",function(){
      curr+=10;
      update();
    })
    document.getElementById("minus").addEventListener("click",function(){
      curr-=10;
      update();
    })
    document.getElementById("reset").addEventListener("click",function(){
      curr=50;
      update();
    })
    window.addEventListener("resize",function(){
      update();
    })
  </script>

<div class="wrapper" id="maps" style="clear:both">
  <br><br>
  <canvas id="single" height="3000px" width="6000px" style="display:none"></canvas>
  <canvas id="double" height="3000px" width="12000px" style="display:none"></canvas>
  <div id="left" style="float:left;margin-left:50px">
    <img class="z1" id="top" src="base.png"/>
    <img class="z2" id="blank" src="land.png"/>
    <img class="z3" id="flat" src="flat.png"/>
    <img class="z4" id="color" src="colors.png"/>
    <img class="z5" id="climate" src="climate.png"/>
    <img class="z6" id="border" src="borders.png"/>
    <img class="z7" id="grid" src="grid.png"/>
    <img class="z8" id="label" src="labels.png"/>
    <canvas class="z9" id="lines"></canvas>
  </div>
  <div id="right" style="float:right;display:none">
    <img class="z1" id="top2" src="base.png"/>
    <img class="z2" id="blank2" src="land.png"/>
    <img class="z3" id="flat2" src="flat.png"/>
    <img class="z4" id="color2" src="colors.png"/>
    <img class="z5" id="climate2" src="climate.png"/>
    <img class="z6" id="border2" src="borders.png"/>
    <img class="z7" id="grid2" src="grid.png"/>
    <img class="z8" id="label2" src="labels.png"/>
    <canvas class="z9" id="lines2"></canvas>
  </div>
</div>

<script>
var prevX=500;
var prevY=500;
var origX=0;
var origY=0;
var dist=0;
var area=0;
var ctx=document.getElementById("lines").getContext("2d");
var ctx2=document.getElementById("lines2").getContext("2d");
ctx.canvas.width=window.innerWidth/2;
ctx.canvas.height=window.innerWidth/4;
ctx2.canvas.width=window.innerWidth/2;
ctx2.canvas.height=window.innerWidth/4;
function waypoint(e) {
  var rect=e.target.getBoundingClientRect();
  var x=(e.clientX-rect.left)/(rect.right-rect.left)*2*Math.PI-Math.PI;
  var y=(e.clientY-rect.top)/(rect.top-rect.bottom)*Math.PI+Math.PI/2;
  if (prevX<500){
    dist+=2*Math.asin(Math.sqrt((Math.sin((prevY-y)/2))**2+Math.cos(prevY)*Math.cos(y)*(Math.sin((prevX-x)/2))**2));
    area+=prevX*Math.cos(prevY)*y-x*Math.cos(y)*prevY;
  }
  else{
    origX=x;
    origY=y;
  }
  prevX=x;
  prevY=y;
  document.getElementById("dist").placeholder=(dist*3959).toFixed(0)+" mi, "+(dist*6371).toFixed(0)+" km";
  ctx.fillRect(e.clientX-rect.left,e.clientY-rect.top,2,2);
  ctx2.fillRect(e.clientX-rect.left,e.clientY-rect.top,2,2);
}
document.getElementById("left").addEventListener("click",function(e){
  waypoint(e);
})
document.getElementById("right").addEventListener("click",function(e){
  waypoint(e);
})
document.getElementById("clear").addEventListener("click",function(){
  prevX=500;
  prevY=500;
  origX=0;
  origY=0;
  dist=0;
  area=0;
  document.getElementById("dist").placeholder="click to set waypoints";
  ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
  ctx2.clearRect(0,0,ctx2.canvas.width,ctx2.canvas.height);
})
document.getElementById("area").addEventListener("click",function(){
  var area2=Math.abs(area+prevX*Math.cos(prevY)*origY-origX*Math.cos(origY)*prevY)/2;
  document.getElementById("dist").placeholder=(area2*3959**2).toFixed(0)+" mi2, "+(area2*6371**2).toFixed(0)+" km2";
})
</script>
  </body>
</html>
